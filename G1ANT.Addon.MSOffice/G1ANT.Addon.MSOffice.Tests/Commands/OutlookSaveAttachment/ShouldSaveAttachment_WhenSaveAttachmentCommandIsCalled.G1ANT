♥outlookInboxFolder = ‴t.g1ant.test@gmail.com\Skrzynka odbiorcza‴
♥toBeSentAttachmentPath = ‴♥environment⟦TEMP⟧\testattachmentsent.txt‴
♥toBeDownloadedAttachmentPath = ‴♥environment⟦TEMP⟧\testattachmentdownloaded.txt‴
♥testAttachmentText = ‴Test text.‴

outlook.open display false

file.exists ♥toBeSentAttachmentPath errorjump ToBeSentAttachmentDoesNotExist timeout 2
    file.delete ♥toBeSentAttachmentPath
label name ToBeSentAttachmentDoesNotExist

file.exists ♥toBeDownloadedAttachmentPath errorjump ToBeDownloadedAttachmentDoesNotExist timeout 2
    file.delete ♥toBeDownloadedAttachmentPath
label name ToBeDownloadedAttachmentDoesNotExist

text.write text ♥testAttachmentText filename ♥toBeSentAttachmentPath

♥attachmentsToBeSent = ⟦list⟧♥toBeSentAttachmentPath❚ 

outlook.newmessage to ‴t.g1ant.test@gmail.com‴ subject ‴Test mail‴ body ‴Test content.‴ attachments ♥attachmentsToBeSent
outlook.send 
delay 5

outlook.open display false
delay 5
outlook.getfolder path ♥outlookInboxFolder result ♥InboxFolder
♥emails = ♥InboxFolder⟦mails⟧
♥mail = ♥emails⟦♥emails.Count⟧
♥attachments = ♥mail⟦attachments⟧
♥attachment = ♥attachments⟦1⟧
outlook.saveattachment ♥attachment path ♥toBeDownloadedAttachmentPath
text.read filename ♥toBeDownloadedAttachmentPath result ♥textFromDownloadedAttachemnt
test ⊂♥textFromDownloadedAttachemnt.Equals(♥testAttachmentText)⊃
outlook.close

file.delete ♥toBeSentAttachmentPath
file.delete ♥toBeDownloadedAttachmentPath