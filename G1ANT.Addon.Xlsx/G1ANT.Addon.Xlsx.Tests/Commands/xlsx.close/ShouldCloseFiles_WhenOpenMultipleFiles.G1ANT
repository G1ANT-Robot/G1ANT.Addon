addon xlsx version 2.205.17304.1000
addon core version 4.99.18340.1354
addon language version 4.99.18340.1354

♥folderPath =♥environment⟦TEMP⟧\
♥filePath1 = ♥folderPath + "TempTestDebug1.xlsx"
♥filePath2 = ♥folderPath + "TempTestDebug2.xlsx"
♥filePath3 = ♥folderPath + "TempTestDebug3.xlsx"
♥filePath4 = ♥folderPath + "TempTestDebug4.xlsx"
♥testValue1 = ‴ABC‴

procedure DeleteTestFileIfExists
    ⊂
        if(System.IO.File.Exists(♥filePath))
        {
            System.IO.File.Delete(♥filePath);
        }
    ⊃
end procedure

procedure DeleteTestFiles
    try errorcall testFailed
    ♥filePath = ♥filePath1
    call DeleteTestFileIfExists
    ♥filePath = ♥filePath2
    call DeleteTestFileIfExists
    ♥filePath = ♥filePath3
    call DeleteTestFileIfExists
    ♥filePath = ♥filePath4
    call DeleteTestFileIfExists   
    end try      
end procedure

procedure CreateTestFiles 
    try errorcall testFailed
    ♥filePath = ♥filePath1
    call CreationWhenOpening
    ♥filePath = ♥filePath2
    call CreationWhenOpening
    ♥filePath = ♥filePath3
    call CreationWhenOpening
    ♥filePath = ♥filePath4
    call CreationWhenOpening 
    call testSucceeded
    end try    
end procedure

procedure CreationWhenOpening 
    try errorcall testFailed
    xlsx.open path ♥filePath createifnotexist true
    xlsx.close     
    end try    
end procedure

procedure testFailed
    test condition no
end procedure

procedure testSucceeded
    test condition yes
end procedure

call DeleteTestFiles
call CreateTestFiles
call DeleteTestFiles

